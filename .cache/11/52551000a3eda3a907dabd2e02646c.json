{"id":"tf1Z","dependencies":[{"name":"C:\\Users\\silve\\Downloads\\s3-demo\\package.json","includedInParent":true,"mtime":1602864672900},{"name":"C:\\Users\\silve\\Downloads\\s3-demo\\.babelrc","includedInParent":true,"mtime":1602860561937},{"name":"C:\\Users\\silve\\Downloads\\s3-demo\\node_modules\\@aws-sdk\\eventstream-marshaller\\package.json","includedInParent":true,"mtime":1602864669401},{"name":"@aws-crypto/crc32","loc":{"line":1,"column":22},"parent":"C:\\Users\\silve\\Downloads\\s3-demo\\node_modules\\@aws-sdk\\eventstream-marshaller\\dist\\es\\splitMessage.js","resolved":"C:\\Users\\silve\\Downloads\\s3-demo\\node_modules\\@aws-crypto\\crc32\\build\\index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.splitMessage=o;var e=require(\"@aws-crypto/crc32\"),t=4,r=2*t,s=4,a=r+2*s;function o(o){var n=o.byteLength,i=o.byteOffset,d=o.buffer;if(n<a)throw new Error(\"Provided message too short to accommodate event stream message overhead\");var c=new DataView(d,i,n),h=c.getUint32(0,!1);if(n!==h)throw new Error(\"Reported message length does not match received message length\");var g=c.getUint32(t,!1),w=c.getUint32(r,!1),m=c.getUint32(n-s,!1),u=(new e.Crc32).update(new Uint8Array(d,i,r));if(w!==u.digest())throw new Error(\"The prelude checksum specified in the message (\"+w+\") does not match the calculated CRC32 checksum (\"+u.digest()+\")\");if(u.update(new Uint8Array(d,i+r,n-(r+s))),m!==u.digest())throw new Error(\"The message checksum (\"+u.digest()+\") did not match the expected value of \"+m);return{headers:new DataView(d,i+r+s,g),body:new Uint8Array(d,i+r+s+g,h-g-(r+s+s))}}"},"sourceMaps":{"js":{"mappings":[{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":0}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":13}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":20}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":35}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":43}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":56}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":57}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":64}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":68}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":76}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":64,"column":1},"generated":{"line":1,"column":89}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":91}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":95}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":97}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":105}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":4,"column":6},"generated":{"line":1,"column":126}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":4,"column":30},"generated":{"line":1,"column":128}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":6,"column":6},"generated":{"line":1,"column":130}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":6,"column":47},"generated":{"line":1,"column":132}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":6,"column":23},"generated":{"line":1,"column":134}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":8,"column":6},"generated":{"line":1,"column":136}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":1,"column":138}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":10,"column":6},"generated":{"line":1,"column":140}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":10,"column":31},"generated":{"line":1,"column":142}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":10,"column":66},"generated":{"line":1,"column":144}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":10,"column":48},"generated":{"line":1,"column":146}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":6},"generated":{"line":1,"column":148}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":16},"generated":{"line":1,"column":157}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":29},"generated":{"line":1,"column":159}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":31},"generated":{"line":1,"column":162}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":31},"generated":{"line":1,"column":166}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":41},"generated":{"line":1,"column":168}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":41},"generated":{"line":1,"column":170}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":43},"generated":{"line":1,"column":181}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":53},"generated":{"line":1,"column":183}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":53},"generated":{"line":1,"column":185}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":55},"generated":{"line":1,"column":196}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":61},"generated":{"line":1,"column":198}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":23,"column":61},"generated":{"line":1,"column":200}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":24,"column":6},"generated":{"line":1,"column":207}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":24,"column":6},"generated":{"line":1,"column":210}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":24,"column":19},"generated":{"line":1,"column":212}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":25,"column":10},"generated":{"line":1,"column":214}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":25,"column":10},"generated":{"line":1,"column":220}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":25,"column":14},"generated":{"line":1,"column":224}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":25,"column":20},"generated":{"line":1,"column":230}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":28,"column":8},"generated":{"line":1,"column":305}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":28,"column":8},"generated":{"line":1,"column":309}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":28,"column":15},"generated":{"line":1,"column":311}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":28,"column":19},"generated":{"line":1,"column":315}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":28,"column":28},"generated":{"line":1,"column":324}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":28,"column":36},"generated":{"line":1,"column":326}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":28,"column":48},"generated":{"line":1,"column":328}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":30,"column":8},"generated":{"line":1,"column":331}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":30,"column":24},"generated":{"line":1,"column":333}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":30,"column":29},"generated":{"line":1,"column":335}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":30,"column":39},"generated":{"line":1,"column":345}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":30,"column":42},"generated":{"line":1,"column":348}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":32,"column":6},"generated":{"line":1,"column":351}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":32,"column":6},"generated":{"line":1,"column":354}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":32,"column":21},"generated":{"line":1,"column":358}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":33,"column":10},"generated":{"line":1,"column":360}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":33,"column":10},"generated":{"line":1,"column":366}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":33,"column":14},"generated":{"line":1,"column":370}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":33,"column":20},"generated":{"line":1,"column":376}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":36,"column":8},"generated":{"line":1,"column":442}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":36,"column":8},"generated":{"line":1,"column":446}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":36,"column":23},"generated":{"line":1,"column":448}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":36,"column":28},"generated":{"line":1,"column":450}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":36,"column":38},"generated":{"line":1,"column":460}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":36,"column":61},"generated":{"line":1,"column":463}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":37,"column":8},"generated":{"line":1,"column":466}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":37,"column":34},"generated":{"line":1,"column":468}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":37,"column":39},"generated":{"line":1,"column":470}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":37,"column":49},"generated":{"line":1,"column":480}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":37,"column":65},"generated":{"line":1,"column":483}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":38,"column":8},"generated":{"line":1,"column":486}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":38,"column":34},"generated":{"line":1,"column":488}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":38,"column":39},"generated":{"line":1,"column":490}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":38,"column":49},"generated":{"line":1,"column":500}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":38,"column":62},"generated":{"line":1,"column":502}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":38,"column":79},"generated":{"line":1,"column":505}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":8},"generated":{"line":1,"column":508}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":22},"generated":{"line":1,"column":511}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":26},"generated":{"line":1,"column":515}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":22},"generated":{"line":1,"column":517}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":34},"generated":{"line":1,"column":524}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":41},"generated":{"line":1,"column":531}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":45},"generated":{"line":1,"column":535}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":56},"generated":{"line":1,"column":546}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":64},"generated":{"line":1,"column":548}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":40,"column":76},"generated":{"line":1,"column":550}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":41,"column":6},"generated":{"line":1,"column":554}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":41,"column":6},"generated":{"line":1,"column":557}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":41,"column":34},"generated":{"line":1,"column":561}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":41,"column":46},"generated":{"line":1,"column":563}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":42,"column":10},"generated":{"line":1,"column":572}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":42,"column":10},"generated":{"line":1,"column":578}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":42,"column":14},"generated":{"line":1,"column":582}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":43,"column":6},"generated":{"line":1,"column":588}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":43,"column":56},"generated":{"line":1,"column":638}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":43,"column":79},"generated":{"line":1,"column":640}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":43,"column":130},"generated":{"line":1,"column":691}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":43,"column":142},"generated":{"line":1,"column":693}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":43,"column":150},"generated":{"line":1,"column":702}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":50,"column":6},"generated":{"line":1,"column":707}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":1,"column":710}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":47,"column":14},"generated":{"line":1,"column":712}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":48,"column":4},"generated":{"line":1,"column":719}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":48,"column":8},"generated":{"line":1,"column":723}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":48,"column":19},"generated":{"line":1,"column":734}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":48,"column":27},"generated":{"line":1,"column":736}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":48,"column":40},"generated":{"line":1,"column":738}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":48,"column":56},"generated":{"line":1,"column":740}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":48,"column":70},"generated":{"line":1,"column":743}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":48,"column":87},"generated":{"line":1,"column":745}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":50,"column":6},"generated":{"line":1,"column":750}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":50,"column":34},"generated":{"line":1,"column":754}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":50,"column":46},"generated":{"line":1,"column":756}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":51,"column":10},"generated":{"line":1,"column":765}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":51,"column":10},"generated":{"line":1,"column":771}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":51,"column":14},"generated":{"line":1,"column":775}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":52,"column":6},"generated":{"line":1,"column":781}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":52,"column":31},"generated":{"line":1,"column":806}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":52,"column":43},"generated":{"line":1,"column":808}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":52,"column":51},"generated":{"line":1,"column":817}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":52,"column":92},"generated":{"line":1,"column":858}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":56,"column":9},"generated":{"line":1,"column":861}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":56,"column":9},"generated":{"line":1,"column":867}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":57,"column":4},"generated":{"line":1,"column":868}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":57,"column":13},"generated":{"line":1,"column":876}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":57,"column":17},"generated":{"line":1,"column":880}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":57,"column":26},"generated":{"line":1,"column":889}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":57,"column":34},"generated":{"line":1,"column":891}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":57,"column":47},"generated":{"line":1,"column":893}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":57,"column":64},"generated":{"line":1,"column":895}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":57,"column":81},"generated":{"line":1,"column":897}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":58,"column":4},"generated":{"line":1,"column":900}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":58,"column":10},"generated":{"line":1,"column":905}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":58,"column":14},"generated":{"line":1,"column":909}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":59,"column":6},"generated":{"line":1,"column":920}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":60,"column":6},"generated":{"line":1,"column":922}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":60,"column":19},"generated":{"line":1,"column":924}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":60,"column":36},"generated":{"line":1,"column":926}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":60,"column":54},"generated":{"line":1,"column":928}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":61,"column":6},"generated":{"line":1,"column":930}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":61,"column":22},"generated":{"line":1,"column":932}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":61,"column":38},"generated":{"line":1,"column":935}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":61,"column":55},"generated":{"line":1,"column":937}},{"source":"../../src/splitMessage.ts","name":null,"original":{"line":61,"column":73},"generated":{"line":1,"column":939}}],"sources":{"../../src/splitMessage.ts":"import { Crc32 } from \"@aws-crypto/crc32\";\n\n// All prelude components are unsigned, 32-bit integers\nconst PRELUDE_MEMBER_LENGTH = 4;\n// The prelude consists of two components\nconst PRELUDE_LENGTH = PRELUDE_MEMBER_LENGTH * 2;\n// Checksums are always CRC32 hashes.\nconst CHECKSUM_LENGTH = 4;\n// Messages must include a full prelude, a prelude checksum, and a message checksum\nconst MINIMUM_MESSAGE_LENGTH = PRELUDE_LENGTH + CHECKSUM_LENGTH * 2;\n\n/**\n * @internal\n */\nexport interface MessageParts {\n  headers: DataView;\n  body: Uint8Array;\n}\n\n/**\n * @internal\n */\nexport function splitMessage({ byteLength, byteOffset, buffer }: ArrayBufferView): MessageParts {\n  if (byteLength < MINIMUM_MESSAGE_LENGTH) {\n    throw new Error(\"Provided message too short to accommodate event stream message overhead\");\n  }\n\n  const view = new DataView(buffer, byteOffset, byteLength);\n\n  const messageLength = view.getUint32(0, false);\n\n  if (byteLength !== messageLength) {\n    throw new Error(\"Reported message length does not match received message length\");\n  }\n\n  const headerLength = view.getUint32(PRELUDE_MEMBER_LENGTH, false);\n  const expectedPreludeChecksum = view.getUint32(PRELUDE_LENGTH, false);\n  const expectedMessageChecksum = view.getUint32(byteLength - CHECKSUM_LENGTH, false);\n\n  const checksummer = new Crc32().update(new Uint8Array(buffer, byteOffset, PRELUDE_LENGTH));\n  if (expectedPreludeChecksum !== checksummer.digest()) {\n    throw new Error(\n      `The prelude checksum specified in the message (${expectedPreludeChecksum}) does not match the calculated CRC32 checksum (${checksummer.digest()})`\n    );\n  }\n\n  checksummer.update(\n    new Uint8Array(buffer, byteOffset + PRELUDE_LENGTH, byteLength - (PRELUDE_LENGTH + CHECKSUM_LENGTH))\n  );\n  if (expectedMessageChecksum !== checksummer.digest()) {\n    throw new Error(\n      `The message checksum (${checksummer.digest()}) did not match the expected value of ${expectedMessageChecksum}`\n    );\n  }\n\n  return {\n    headers: new DataView(buffer, byteOffset + PRELUDE_LENGTH + CHECKSUM_LENGTH, headerLength),\n    body: new Uint8Array(\n      buffer,\n      byteOffset + PRELUDE_LENGTH + CHECKSUM_LENGTH + headerLength,\n      messageLength - headerLength - (PRELUDE_LENGTH + CHECKSUM_LENGTH + CHECKSUM_LENGTH)\n    ),\n  };\n}\n"},"lineCount":null}},"error":null,"hash":"935d80750ba398b0cea9ddb8d3342f86","cacheData":{"env":{}}}